<mvc:View controllerName="com.cy.rbm.controller.SettlementWorkbenchDetail"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:uxap="sap.uxap"
    xmlns:f="sap.f"
    xmlns:card="sap.f.cards"
    xmlns:layout="sap.ui.layout"
    xmlns:suite="sap.suite.ui.commons"
    xmlns:core="sap.ui.core"
    xmlns:form="sap.ui.layout.form">
    <uxap:ObjectPageLayout id="ObjectPageLayout" showTitleInHeaderContent="true" showHeaderContent="true">
        <uxap:headerTitle>
            <uxap:ObjectPageDynamicHeaderTitle>
                <uxap:expandedHeading>
                    <Title text="{settlement>id}" wrapping="true" />
                </uxap:expandedHeading>
                <uxap:snappedHeading>
                    <Title text="{settlement>id}" wrapping="true" />
                </uxap:snappedHeading>
                <uxap:breadcrumbs>
                    <Breadcrumbs>
                        <Link text="Settlement Workbench" press="onNavBack" />
                        <Link text="{settlement>id}" />
                    </Breadcrumbs>
                </uxap:breadcrumbs>
                <uxap:actions>
                    <Button text="Post to FI" visible="{settlement>p}" type="Ghost" icon="sap-icon://upload" press="onOpenPostSettlementDialog" />
                    <Button text="Add Adjustment" type="Ghost" icon="sap-icon://add" press="onOpenAdjustmentDialog" />
                    <Button text="Approve" visible="{settlement>a}" type="Success" icon="sap-icon://accept" press="onOpenApproveSettlementDialog" />
                    <Button text="Reject" visible="{settlement>a}" type="Reject" icon="sap-icon://decline" press="onOpenRejectSettlementDialog" />
                </uxap:actions>
                
            </uxap:ObjectPageDynamicHeaderTitle>
        </uxap:headerTitle>

        <uxap:headerContent>
            <FlexBox wrap="Wrap" fitContainer="true" alignItems="Stretch">
                <Avatar src="{settlement>statusIcon}" backgroundColor="{path: 'settlement>statusText',formatter: '.formatAvatarColor'}"  displaySize="L" class="sapUiTinyMarginEnd" />
                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                    <Label text="Partner" />
                    <ObjectAttribute title="{settlement>partner}" text="CUST-001" />
                </layout:VerticalLayout>
                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                    <Label text="Period" />
                    <ObjectAttribute text="2025-Q1" />
                </layout:VerticalLayout>
                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                    <Label text="Status" />
                    <ObjectStatus text="{settlement>statusText}" state="{settlement>statusState}" inverted="true" />
                </layout:VerticalLayout>
                <layout:VerticalLayout class="sapUiSmallMarginBeginEnd">
                    <Label text="Total Amount" />
                    <ObjectNumber number="1,56,000" unit="INR" state="Success" emphasized="true" />
                </layout:VerticalLayout>
            </FlexBox>
        </uxap:headerContent>

        <uxap:sections>
            <uxap:ObjectPageSection title="Summary">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection title="ðŸ“Š Settlement Reconciliation Flow">
                        <uxap:blocks>
                            <VBox justifyContent="SpaceAround" width = "100%" alignItems="Center">
                                <HBox justifyContent="SpaceAround" width = "100%" alignItems="Center" class="sapUiMediumMargin">
                                    <VBox alignItems="Center" class="cardWhite">
                                        <Label text="Total Accrued" />
                                        <Title text="â‚¹1,00,000" level="H3" />
                                        <Text text="3 Periods" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <core:Icon src="sap-icon://arrow-right" size="2rem" color="#888" />
                                    <VBox alignItems="Center" class="cardWhite">
                                        <Label text="Adjustments" />
                                        <Title text="+â‚¹56,000" level="H3" class="sapUiPositiveText" />
                                        <Text text="2 Entries" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <core:Icon src="sap-icon://arrow-right" size="2rem" color="#888" />
                                    <VBox alignItems="Center" class="cardWhite">
                                        <Label text="Final Settlement" />
                                        <Title text="â‚¹1,56,000" level="H1" />
                                        <ObjectStatus text="Delta +56%" state="Success" class="sapUiTinyMarginTop" />
                                    </VBox>
                                </HBox>
                                <!-- <ToolbarSeparator ></ToolbarSeparator> -->
                                <ToolbarSpacer ></ToolbarSpacer>
                                <HBox alignItems="Center">
                                    <Text text="ðŸ“ˆ Delta: +â‚¹56,000 (+56% vs accrued)"></Text>
                                </HBox>

                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                    <uxap:ObjectPageSubSection title="ðŸ“‹ Settlement Summary">
                        <uxap:blocks>
                            <VBox justifyContent="SpaceAround" width = "100%" alignItems="Center">
                                <HBox justifyContent="SpaceAround" width = "100%" alignContent="Center" class="sapUiMediumMargin">
                                    <VBox alignItems="Start" width = "100%" class="cardPurple sapUiMediumMarginStartEnd">
                                        <Label text="Total Accrued" />
                                        <Title text="â‚¹1,00,000" level="H3" />
                                        <Text text="3 Periods" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <VBox alignItems="Start" width = "100%" class="cardGreen sapUiMediumMarginStartEnd">
                                        <Label text="Adjustments" />
                                        <Title text="+â‚¹56,000" level="H3" class="sapUiPositiveText" />
                                        <Text text="2 Entries" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <VBox alignItems="Start" width = "100%" class="cardBlue sapUiMediumMarginStartEnd">
                                        <Label text="Final Settlement" />
                                        <Title text="â‚¹1,56,000" level="H1" />
                                        <ObjectStatus text="Delta +56%" state="Success" class="sapUiTinyMarginTop" />
                                    </VBox>

                                    <VBox alignItems="Start" width = "100%" class="cardYellow sapUiMediumMarginStartEnd">
                                        <Label text="Payment Due" />
                                        <Title text="15-Apr" level="H1" />
                                        <ObjectStatus text="10 days remaining" class="sapUiTinyMarginTop" />
                                    </VBox>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                    <uxap:ObjectPageSubSection title="ðŸ“’ Accounting Impact">
                        <uxap:blocks>
                            <VBox justifyContent="SpaceAround" width = "100%" alignItems="Center">
                                <HBox justifyContent="SpaceAround" width = "100%" alignItems="Center" class="sapUiMediumMargin ">
                                    <VBox alignItems="Center" width = "100%" class="cardRed sapUiMediumMarginStartEnd">
                                        <Label text="Debit" />
                                        <Title text="â‚¹1,56,000" level="H3" />
                                        <Text text="2100500 - Accrued Rebate Liability" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <VBox alignItems="Center" width = "100%" class="cardGreen sapUiMediumMarginStartEnd">
                                        <Label text="Credit" />
                                        <Title text="â‚¹1,56,000" level="H3" class="sapUiPositiveText" />
                                        <Text text="2000100 - Accounts Payable - Partner" class="sapUiTinyMarginTop" />
                                    </VBox>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>

            <uxap:ObjectPageSection title="Reconciliation">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection title="ðŸ“Š Accrual Breakdown">
                        <uxap:blocks>
                            <VBox justifyContent="SpaceAround" width = "100%" alignItems="Center">
                                <HBox justifyContent="SpaceAround" width = "100%" alignItems="Center">
                                    <VBox alignItems="Start" width = "100%" class="cardPurple sapUiMediumMarginStartEnd ">
                                        <Label text="January 2025" />
                                        <Title text="â‚¹32,000" level="H3" />
                                        <Text text="RUN-2025-01-001" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <VBox alignItems="Start" width = "100%" class="cardPurple sapUiMediumMarginStartEnd">
                                        <Label text="February 2025" />
                                        <Title text="â‚¹35,000" level="H3" />
                                        <Text text="RUN-2025-02-001" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <VBox alignItems="Start" width = "100%" class="cardPurple sapUiMediumMarginStartEnd">
                                        <Label text="March 2025" />
                                        <Title text="â‚¹33,000" level="H3" />
                                        <Text text="RUN-2025-03-001" class="sapUiTinyMarginTop" />
                                    </VBox>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                    <uxap:ObjectPageSubSection title="ðŸ§® Settlement Calculation">
                        <uxap:blocks>
                            <VBox justifyContent="SpaceBetween" width = "100%" alignItems="Start">
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom cardGreen">
                                    <VBox alignItems="Start">
                                        <Label text="Total Accrued (Q1)" />
                                        <Text text="Sum of 3 monthly accruals" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="â‚¹1,00,000" level="H3" />
                                    </VBox>
                                </HBox>
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom cardGreen">
                                    <VBox alignItems="Start">
                                        <Label text="Prior Settlements" />
                                        <Text text="No prior settlements in this periods" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="â‚¹0" level="H3" />
                                    </VBox>
                                </HBox>
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom cardGreen">
                                    <VBox alignItems="Start">
                                        <Label text="Adjustments" />
                                        <Text text="2 adjustment entries" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="+â‚¹56,000" level="H3" />
                                    </VBox>
                                </HBox>
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom">
                                    <VBox alignItems="Start">
                                        <Label text="Net Settlement Amount" />
                                    </VBox>
                                    <HBox alignItems="End">
                                        <Title text="â‚¹1,56,000" level="H3" />
                                    </HBox>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>

            <uxap:ObjectPageSection title="Adjustments">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <VBox justifyContent="SpaceBetween" width = "100%" alignItems="Start">
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom cardGreen">
                                    <VBox alignItems="Start">
                                        <Text text="Retroactive Rate Correction" />
                                        <Label text="Added by Priya Sharma â€¢ 03-Apr-2025 â€¢ Reason: Tier 3 rate applied from Jan" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="+â‚¹45,000" level="H3" />
                                    </VBox>
                                </HBox>
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom cardGreen">
                                    <VBox alignItems="Start">
                                        <Text text="Dispute Resolution - INV-2025-00234" />
                                        <Label text="Added by Rahul Kumar â€¢ 04-Apr-2025 â€¢ Reason: Missing invoice added" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="+â‚¹11,000" level="H3" />
                                    </VBox>
                                </HBox>
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom">
                                    <VBox alignItems="Start">
                                        <Text text="Total Adjustments" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="+â‚¹56,000" level="H3" />
                                    </VBox>
                                </HBox>
                            </VBox>

                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>

            <uxap:ObjectPageSection title="Disputes">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection title="âš–ï¸ Dispute Summary">
                        <uxap:blocks>
                            <VBox justifyContent="SpaceAround" width = "100%" alignItems="Center">
                                <HBox justifyContent="SpaceAround" width="100%">
                                    <VBox alignItems="Center" class="sapUiMediumMargin cardWhite">
                                        <Title text="1" level="H1" class="sapUiPositiveText" />
                                        <Label text="Included in Settlement" />
                                        <Text text="â‚¹{detailModel>/disputes/included/amount}" />
                                    </VBox>
                                    <VBox alignItems="Center" class="sapUiMediumMargin cardWhite">
                                        <Title text="2" level="H1" class="sapUiCriticalText" />
                                        <Label text="Excluded (Pending)" />
                                        <Text text="â‚¹{detailModel>/disputes/excluded/amount}" />
                                    </VBox>
                                    <VBox alignItems="Center" class="sapUiMediumMargin cardWhite">
                                        <Title text="0" level="H1" />
                                        <Label text="Deferred" />
                                        <Text text="â‚¹{detailModel>/disputes/deferred/amount}" />
                                    </VBox>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                    <uxap:ObjectPageSubSection title="âš ï¸ Excluded Disputes">
                        <uxap:blocks>

                            <VBox justifyContent="SpaceBetween" width = "100%" alignItems="Start">
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom cardYellow">
                                    <VBox alignItems="Start">
                                        <Text text="DSP-2025-0043 - Rate Disagreement" />
                                        <Label text="Under review â€¢ Will be resolved in next settlement cycle" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="â‚¹45,000" level="H3" />
                                    </VBox>
                                </HBox>
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiSmallMarginTopBottom cardYellow">
                                    <VBox alignItems="Start">
                                        <Text text="DSP-2025-0044 - Missing Credit Note" />
                                        <Label text="Awaiting documentation from partner" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="â‚¹2,700" level="H3" />
                                    </VBox>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                    <uxap:ObjectPageSubSection title="âœ… Included Dispute">
                        <uxap:blocks>

                            <VBox justifyContent="SpaceBetween" width = "100%" alignItems="Start" class="cardGreen">
                                <HBox justifyContent="SpaceBetween" width = "100%" class="sapUiMediumMarginTopBottom">
                                    <VBox alignItems="Start">
                                        <Text text="DSP-2025-0042 - Missing Invoice" />
                                        <Label text="Resolved by Rahul Kumar â€¢ 04-Apr-2025 â€¢ Added as adjustment" />
                                    </VBox>
                                    <VBox alignItems="End">
                                        <Title text="â‚¹11,000" level="H3" />
                                    </VBox>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>

            </uxap:ObjectPageSection>

            <uxap:ObjectPageSection title="Line Items">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <VBox >
                                <Table items="{settlement>/lineItems}">
                                    <columns>
                                        <Column>
                                            <Text text="Period" />
                                        </Column>
                                        <Column>
                                            <Text text="Description" />
                                        </Column>
                                        <Column>
                                            <Text text="Accrual Run" />
                                        </Column>
                                        <Column hAlign="End">
                                            <Text text="Base Amount" />
                                        </Column>
                                        <Column hAlign="End">
                                            <Text text="Rate" />
                                        </Column>
                                        <Column hAlign="End">
                                            <Text text="Accrual Amount" />
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <Text text="{settlement>period}" />
                                            <Text text="{settlement>desc}" />
                                            <Text text="{settlement>desc}" />
                                            <Text text="{settlement>base}" />
                                            <Text text="{settlement>rate}" />
                                            <Text text="{settlement>amount}" />
                                        </ColumnListItem>
                                    </items>
                                </Table>
                                <HBox width="100%" alignContent="End" justifyContent="End">
                                    <Text text="Total Accruals:	â‚¹1,00,000"></Text>
                                </HBox>
                            </VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>

            <uxap:ObjectPageSection title="Approval History">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <suite:Timeline content="{settlement>/history}">
                                <suite:content>
                                    <suite:TimelineItem dateTime="{settlement>dateTime}" title="{settlement>title}" userName="{settlement>user}" icon="{settlement>icon}" status="{settlement>status}" />
                                </suite:content>
                            </suite:Timeline>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <uxap:ObjectPageSection title="Settlement Details">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <HBox justifyContent="SpaceBetween" width = "100%">
                                <VBox justifyContent="SpaceBetween" width = "100%" alignItems="Start" class="sapUiTinyMargin">
                                    <VBox alignItems="Stretch" width="100%" class="sapUiTinyMarginTopBottom cardPurple">
                                        <Label text="Created By" />
                                        <Title text="Rahul Kumar" level="H3" />
                                        <Text text="01-Apr-2025" class="sapUiTinyMarginTop" />
                                    </VBox>
                                    <VBox alignItems="Stretch" width="100%" class="sapUiTinyMarginTopBottom  cardPurple">
                                        <Label text="Settlement Frequency" />
                                        <Title text="Quarterly" level="H3" />
                                        <Text text="Every 3 months" class="sapUiTinyMarginTop" />
                                    </VBox>
                                </VBox>
                                <VBox justifyContent="SpaceBetween" width = "100%" alignItems="Start" class="sapUiTinyMargin">
                                    <VBox alignItems="Stretch" width="100%" class="sapUiTinyMarginTopBottom  cardPurple">
                                        <Label text="Last Modified" />
                                        <Title text="05-Apr-2025" level="H3" />
                                        <Text text="By Rahul Kumar" class="sapUiTinyMarginTop" />
                                    </VBox>

                                    <VBox alignItems="Stretch" width="100%" class="sapUiTinyMarginTopBottom  cardPurple">
                                        <Label text="Payment Terms" />
                                        <Title text="Net 15" level="H3" />
                                        <Text text="Bank Transfer" class="sapUiTinyMarginTop" />
                                    </VBox>
                                </VBox>
                            </HBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
        </uxap:sections>
    </uxap:ObjectPageLayout>
</mvc:View>
