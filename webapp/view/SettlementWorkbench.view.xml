<mvc:View
    controllerName="com.cy.rbm.controller.SettlementWorkbench"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.ui.layout">

    <f:DynamicPage  headerExpanded="true">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="Settlement Workbench"/>
                </f:heading>
                <f:expandedContent>
                    <Label text="Review, adjust, and approve settlements for payment"/>
                </f:expandedContent>
                <f:actions>
                    <Button text="Refresh" icon="sap-icon://refresh" press="onRefresh"/>
                    <Button text="Export" icon="sap-icon://excel-attachment" press="onExport"/>
                    <Button text="Create Settlement" type="Emphasized" icon="sap-icon://add" press="onOpenCreateSettlementDialog"/>
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>

        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <f:content>
                    <HBox wrap="Wrap" displayInline="true" justifyContent="SpaceAround">
                        <GenericTile frameType="OneByHalf" header="Total Settlements" subheader="All Status" class="sapUiTinyMarginBegin">
                            <TileContent>
                                <NumericContent value="8" icon="sap-icon://crm-service-manager" />
                            </TileContent>
                        </GenericTile>
                        <GenericTile frameType="OneByHalf" header="Pending" subheader="Action Required" class="sapUiTinyMarginBegin">
                            <TileContent>
                                <NumericContent value="4" valueColor="Critical" icon="sap-icon://pending" />
                            </TileContent>
                        </GenericTile>
                        <GenericTile frameType="OneByHalf" header="Approved" subheader="Ready to Post" class="sapUiTinyMarginBegin">
                            <TileContent>
                                <NumericContent value="2" valueColor="Good" icon="sap-icon://accept" />
                            </TileContent>
                        </GenericTile>
                        <GenericTile frameType="OneByHalf" header="Posted" subheader="Ready to Post" class="sapUiTinyMarginBegin">
                            <TileContent>
                                <NumericContent value="1" valueColor="Neutral" icon="sap-icon://upload" />
                            </TileContent>
                        </GenericTile>
                        <GenericTile frameType="OneByHalf" header="Ready for Payment" subheader="INR" class="sapUiTinyMarginBegin">
                            <TileContent>
                                <NumericContent value="45.6L" scale="INR" valueColor="Neutral" />
                            </TileContent>
                        </GenericTile>
                    </HBox>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>

        <f:content>
            <Table id="settlementTable" inset="false" items="{settlement>/settlements}" mode="SingleSelectMaster" itemPress="onNavToDetail">
                <headerToolbar>
                    <OverflowToolbar>
                        <content>
                            <Select forceSelection="true" selectedKey="2025-Q1">
                                <core:Item key="All" text="All Periods"/>
                                <core:Item key="2025-Q1" text="2025-Q1"/>
                                <core:Item key="2024-Q4" text="2024-Q4"/>
                            </Select>
                            <Select forceSelection="true">
                                <core:Item key="All" text="All Partners"/>
                                <core:Item key="abc" text="ABC Retail"/>
                            </Select>
                            <Select forceSelection="true">
                                <core:Item key="All" text="All Agreements"/>
                                <core:Item key="a1" text="AGR-2025-001"/>
                                <core:Item key="a2" text="AGR-2025-002"/>
                            </Select>
                            <ToolbarSpacer/>
                            <SearchField width="20%" placeholder="Search settlements..."/>
                            <Button icon="sap-icon://sort" type="Ghost"/>
                            <Button icon="sap-icon://calendar" type="Ghost" text="Schedule" press="onOpenScheduleSettlementDialog"/>
                            <Button icon="sap-icon://accept" type="Ghost" text="Bulk Approve" press="onBulkApprove"/>
                            <Button icon="sap-icon://synchronize" type="Ghost" press="onRefresh"/>
                        </content>
                    </OverflowToolbar>
                </headerToolbar>
                <columns>
                    <Column><Text text="Settlement #"/></Column>
                    <Column><Text text="Period"/></Column>
                    <Column><Text text="Partner"/></Column>
                    <Column><Text text="Agreement"/></Column>
                    <Column><Text text="Status"/></Column>
                    <Column hAlign="End"><Text text="Accrued"/></Column>
                    <Column hAlign="End"><Text text="Adjustments"/></Column>
                    <Column hAlign="End"><Text text="Settlement Amt"/></Column>
                    <Column><Text text="Due Date"/></Column>
                    <Column hAlign="Center" minScreenWidth="Tablet"><Text text="Actions"/></Column>
                </columns>
                <items>
                    <ColumnListItem>
                        <cells>
                            <ObjectIdentifier title="{settlement>id}"/>
                            <Text text="{settlement>period}" />
                            <Text text="{settlement>partner}" />
                            <Text text="{settlement>agreement}" />
                            <ObjectStatus text="{settlement>statusText}" state="{settlement>statusState}" icon="{settlement>statusIcon}" />
                            <Text text="{settlement>accrued}" />
                            <ObjectNumber number="{settlement>adjustments}" state="{settlement>adjustmentState}" />
                            <ObjectNumber number="{settlement>amount}" unit="INR" state="Success" />
                            <Text text="{settlement>dueDate}" />
                            <HBox justifyContent="Center">
                                <Button icon="sap-icon://show" visible="{settlement>e}" type="Ghost" press="onNavToDetail" tooltip="View"/>
                                <Button icon="sap-icon://accept" visible="{settlement>a}" type="Success"  press="onOpenApproveSettlementDialog" tooltip="Approve"/>
                                <Button icon="sap-icon://upload" visible="{settlement>p}" type="Ghost" press="onOpenPostSettlementDialog" tooltip="Post"/>
                                <Button icon="sap-icon://edit" visible="{settlement>r}" type="Ghost" press="onPayment" tooltip="Review"/>
                                <Button icon="sap-icon://credit-card" visible="{settlement>c}" type="Ghost" press="onReview" tooltip="Payment"/>
                            </HBox>
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
        </f:content>
    </f:DynamicPage>
</mvc:View>